import{l as y,C as h,A as w,I as n,B as _,J as u,D as d,aM as B,al as p,E as C,b0 as D,h as m,aQ as k}from"./index-DrZMjmv9.js";import{_ as N,a as R}from"./ResAddOrEdit-3gPl7Vq8.js";import{_ as z}from"./Tree-DNLilPF-.js";import{_ as A}from"./Input-AGQs7Bn2.js";import"./_isme_icons-CUZYZBf_.js";import"./useForm-CG-yDGX1.js";import"./QuestionLabel-Cr5WASll.js";import"./Select-B6wqMYzm.js";import"./Tag-BrLFFiz0.js";import"./create-BGkfZJ4H.js";import"./Eye-CJXJszYF.js";import"./Switch-C3KDMXR3.js";import"./InputNumber-Dbw5Qrtk.js";import"./Add-BTul0XN7.js";import"./Checkbox-BeROFyCp.js";const E={class:"flex"},L={__name:"MenuTree",props:{treeData:{type:Array,default:()=>[]},currentMenu:{type:Object,default:()=>null}},emits:["refresh","update:currentMenu"],setup(o,{emit:x}){const r=x,a=y(""),c=y(null);async function f(t={}){c.value?.handleOpen({action:"add",title:"新增菜单",row:{type:"MENU",...t},okText:"保存"})}function M(t,e,{action:s,node:i}){r("update:currentMenu",s==="select"?i:null)}function v({option:t}){return m("i",{class:`${t.icon}?mask text-16`})}function g({option:t}){return[m(p,{text:!0,type:"primary",title:"新增下级菜单",size:"tiny",onClick:k(()=>f({parentId:t.id}),["stop"])},{default:()=>"新增"}),m(p,{text:!0,type:"error",size:"tiny",style:"margin-left: 12px;",onClick:k(()=>$(t),["stop"])},{default:()=>"删除"})]}function $(t){$dialog.confirm({content:`确认删除【${t.name}】？`,async confirm(){try{$message.loading("正在删除",{key:"deleteMenu"}),await R.deletePermission(t.id),$message.success("删除成功",{key:"deleteMenu"}),r("refresh"),r("update:currentMenu",null)}catch(e){console.error(e),$message.destroy("deleteMenu")}}})}return(t,e)=>{const s=A,i=z,b=D;return w(),h("div",null,[n(b,{vertical:"",size:12},{default:_(()=>[e[4]||(e[4]=u("h3",null,"菜单",-1)),u("div",E,[n(s,{value:d(a),"onUpdate:value":e[0]||(e[0]=l=>B(a)?a.value=l:null),placeholder:"搜索",clearable:""},null,8,["value"]),n(d(p),{class:"ml-12",type:"primary",onClick:e[1]||(e[1]=l=>f())},{default:_(()=>[...e[3]||(e[3]=[u("i",{class:"i-material-symbols:add mr-4 text-14"},null,-1),C(" 新增 ",-1)])]),_:1})]),n(i,{"show-irrelevant-nodes":!1,pattern:d(a),data:o.treeData,"selected-keys":[o.currentMenu?.code],"render-prefix":v,"render-suffix":g,"on-update:selected-keys":M,"key-field":"code","label-field":"name","block-line":"","default-expand-all":""},null,8,["pattern","data","selected-keys"])]),_:1}),n(N,{ref_key:"modalRef",ref:c,menus:o.treeData,onRefresh:e[2]||(e[2]=l=>r("refresh",l))},null,8,["menus"])])}}};export{L as default};
