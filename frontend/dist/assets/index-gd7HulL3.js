import{_ as T}from"./TheFooter-D-cLa1qG.js";import{b5 as _,a_ as U,l as x,b6 as h,b7 as V,C as $,J as n,I as l,E as b,F as D,D as o,B as u,b8 as C,aG as L,al as A,w as F,v as K,A as q}from"./index-DrZMjmv9.js";import{t as E}from"./common-Ci7I2wDr.js";import{_ as J}from"./Input-AGQs7Bn2.js";import{_ as G}from"./Checkbox-BeROFyCp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Eye-CJXJszYF.js";const M="/assets/login_banner-BD2eW0TC.webp",W="/assets/logo-Bw3FJMyu.png",j={toggleRole:m=>_.post("/auth/role/toggle",m),login:m=>_.post("/auth/login",m,{needToken:!1}),getUser:()=>_.get("/user/detail")},z={class:"wh-full flex-col bg-[url(@/assets/images/login_bg.webp)] bg-cover"},H={class:"m-auto max-w-700 min-w-345 f-c-c rounded-8 auto-bg bg-opacity-20 bg-cover p-12 card-shadow"},O={class:"w-320 flex-col px-20 py-32"},P={class:"f-c-c text-24 text-#6a6a6a font-normal"},X={class:"mt-20 flex items-center"},Y=["src"],Z={class:"mt-20 flex items-center"},re={__name:"index",setup(m){const B=U(),k=K(),c=F(),S="Vue Naive Admin",t=x({username:"",password:""}),f=x(""),p=E(()=>{f.value=`https://m1.apifoxmock.com/m1/3776410-3408296-default/auth/captcha?${Date.now()}`},500),v=h.get("loginInfo");v&&(t.value.username=v.username||"",t.value.password=v.password||""),p();function I(){t.value.username="admin",t.value.password="123456",d(!0)}const y=V("isRemember",!0),w=x(!1);async function d(i){const{username:e,password:a,captcha:g}=t.value;if(!e||!a)return $message.warning("请输入用户名和密码");if(!i&&!g)return $message.warning("请输入验证码");try{w.value=!0,$message.loading("正在验证，请稍后...",{key:"login"});const{data:r}=await j.login({username:e,password:a.toString(),captcha:g,isQuick:i});y.value?h.set("loginInfo",{username:e,password:a}):h.remove("loginInfo"),N(r)}catch(r){r?.code===10003&&p(),$message.destroy("login"),console.error(r)}w.value=!1}async function N(i={}){B.setToken(i),$message.loading("登录中...",{key:"login"});try{if($message.success("登录成功",{key:"login"}),c.query.redirect){const e=c.query.redirect;delete c.query.redirect,k.push({path:e,query:c.query})}else k.push("/")}catch(e){console.error(e),$message.destroy("login")}}return(i,e)=>{const a=J,g=G,r=A,R=T;return q(),$("div",z,[n("div",H,[e[14]||(e[14]=n("div",{class:"hidden w-380 px-20 py-35 md:block"},[n("img",{src:M,class:"w-full",alt:"login_banner"})],-1)),n("div",O,[n("h2",P,[e[8]||(e[8]=n("img",{src:W,class:"mr-12 h-50"},null,-1)),b(" "+D(o(S)),1)]),l(a,{value:o(t).username,"onUpdate:value":e[0]||(e[0]=s=>o(t).username=s),autofocus:"",class:"mt-32 h-40 items-center",placeholder:"请输入用户名",maxlength:20},{prefix:u(()=>[...e[9]||(e[9]=[n("i",{class:"i-fe:user mr-12 opacity-20"},null,-1)])]),_:1},8,["value"]),l(a,{value:o(t).password,"onUpdate:value":e[1]||(e[1]=s=>o(t).password=s),class:"mt-20 h-40 items-center",type:"password","show-password-on":"mousedown",placeholder:"请输入密码",maxlength:20,onKeydown:e[2]||(e[2]=C(s=>d(),["enter"]))},{prefix:u(()=>[...e[10]||(e[10]=[n("i",{class:"i-fe:lock mr-12 opacity-20"},null,-1)])]),_:1},8,["value"]),n("div",X,[l(a,{value:o(t).captcha,"onUpdate:value":e[3]||(e[3]=s=>o(t).captcha=s),class:"h-40 items-center",palceholder:"请输入验证码",maxlength:4,onKeydown:e[4]||(e[4]=C(s=>d(),["enter"]))},{prefix:u(()=>[...e[11]||(e[11]=[n("i",{class:"i-fe:key mr-12 opacity-20"},null,-1)])]),_:1},8,["value"]),o(f)?(q(),$("img",{key:0,src:o(f),alt:"验证码",height:"40",class:"ml-12 w-80 cursor-pointer",onClick:e[5]||(e[5]=(...s)=>o(p)&&o(p)(...s))},null,8,Y)):L("",!0)]),l(g,{class:"mt-20",checked:o(y),label:"记住我","on-update:checked":s=>y.value=s},null,8,["checked","on-update:checked"]),n("div",Z,[l(r,{class:"h-40 flex-1 rounded-5 text-16",type:"primary",ghost:"",onClick:e[6]||(e[6]=s=>I())},{default:u(()=>[...e[12]||(e[12]=[b(" 一键体验 ",-1)])]),_:1}),l(r,{class:"ml-32 h-40 flex-1 rounded-5 text-16",type:"primary",loading:o(w),onClick:e[7]||(e[7]=s=>d())},{default:u(()=>[...e[13]||(e[13]=[b(" 登录 ",-1)])]),_:1},8,["loading"])])])]),l(R,{class:"py-12"})])}}};export{re as default};
